# Tasks: BATCH-PR-20260227-03
Date: 2026-02-27
Source Audit: src-production-readiness-audit-013.md
Source Delta: docs/deltas/BATCH-PR-20260227-03.md

## Phase P0 (Blockers)
None.

## Phase P1 (High)
- [x] `PR3-P1-01` — Contain logger exceptions in transport and health runtime paths
  - `batch:` BATCH-PR-20260227-03
  - `severity:` P1
  - `addresses_audit:` src-production-readiness-audit-013.md:P1 — NB-51 logger containment gap in runtime subcomponents
  - `enforces_nbrc:` NB-51
  - `targets:` src/Transport/TcpTransport.php, src/Health/ConnectionManager.php, tests/Unit/Transport/TcpTransportTest.php, tests/Unit/Health/ConnectionManagerTest.php
  - `required_changes:`
  - Introduce guarded non-throwing logging helper methods in `TcpTransport` and `ConnectionManager`.
  - Replace direct runtime-path logger calls with guarded helper usage in timeout clamp, transport error logging, and circuit transition logging.
  - Preserve structured context fields (`server_key`, `operation`, circuit transition metadata).
  - `acceptance_criteria:`
  - Throwing logger implementations do not bubble exceptions from transport timeout-clamp/error paths.
  - Throwing logger implementations do not bubble exceptions from connection-manager circuit-transition logging.
  - Runtime state transitions and reconnect behavior remain unchanged except for exception containment.
  - `required_tests:`
  - tests/Unit/Transport/TcpTransportTest.php: add regression with throwing logger during normalize/logTransportError path.
  - tests/Unit/Health/ConnectionManagerTest.php: add regression with throwing logger during circuit transitions.
  - `invariants_must_hold:`
  - Tick loop remains non-blocking.
  - Logger failures never terminate runtime processing.
  - Reconnect fairness and timeout semantics remain deterministic.

- [x] `PR3-P1-02` — Contain logger exceptions in correlation overflow path
  - `batch:` BATCH-PR-20260227-03
  - `severity:` P1
  - `addresses_audit:` src-production-readiness-audit-013.md:P1 — NB-51 logger containment gap in runtime subcomponents
  - `enforces_nbrc:` NB-51
  - `targets:` src/Correlation/CorrelationRegistry.php, tests/Unit/Correlation/CorrelationRegistryTest.php, tests/Integration/CallbackExceptionIsolationTest.php
  - `required_changes:`
  - Add a non-throwing logging wrapper inside `CorrelationRegistry`.
  - Route correlation safety-cap overflow warning through containment wrapper.
  - Ensure overflow metrics increment and event correlation behavior remain intact under logger failures.
  - `acceptance_criteria:`
  - Correlation overflow handling does not throw when logger backend throws.
  - Pending action correlation completion/failure semantics are unchanged.
  - Tick processing continuity is preserved when overflow telemetry logging fails.
  - `required_tests:`
  - tests/Unit/Correlation/CorrelationRegistryTest.php: add overflow-path test with throwing logger.
  - tests/Integration/CallbackExceptionIsolationTest.php: extend/cover runtime continuity with logger failure in correlation path.
  - `invariants_must_hold:`
  - No cross-node ActionID contamination.
  - Correlation registry remains bounded.
  - Logger failures never break runtime correlation flow.

## Phase P2 (Medium)
None.

## Phase P3 (Low)
None.
